{% extends 'base.html.twig' %}

{% form_theme search_form 'bootstrap_5_layout.html.twig' %}

{% block title %}Dashboard{% endblock %}


{% block stylesheets %}
    {{ parent() }}

    <style>
        .table-wrapper {
            width: 100%;
            max-height: 400px;
            overflow: auto;
            display:inline-block;
        }
    </style>
{% endblock %}


{% block javascripts %}
    {{ parent() }}
{% endblock %}


{% block body %}


    <div class="container  bg-light">
        <h3>Filtro de Pesquisa de Resultados</h3>
        {{ form_start(search_form)}}

        <form class="row g-3 ">
            <div class="row g-3">
                <div class="col-sm-3">
                    {#<input type="text" class="form-control" placeholder="Data de Inicio" aria-label="Data de Inicio">#}
                    {{ form_row(search_form.data_inicio) }}
                </div>
                <div class="col-sm-3">
                    {#<input type="text" class="form-control" placeholder="Data de Fim" aria-label="Data de Inicio">#}
                    {{ form_row(search_form.data_fim) }}
                </div>
                <div class="col-sm-3">
                    <input type="submit" class="btn btn-primary" value="Filtrar">
                    <input type="button" class="btn btn-secondary" value="Limpar" onclick="clearForm();">
                </div>
            </div>
            {{ form_rest(search_form) }}
            {{ form_end(search_form) }}
            <br>

            </div> 




            <div class="container">
                <hr/>


                <div class="row">
                    <div class="col">

                        <h2>CANDIDATOS</h2>
                        <table class="table  table-striped">
                            <thead>         
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">MÉDIA</th>
                                    <th scope="col">TOTAL</th>
                                </tr>
                            </thead>          

                            <tbody>
                                <tr>
                                    <td>Hoje</td>
                                    <td>{{ results['candidatosToday'] }}</td>
                                    <td>{{ results['candidatosToday'] }}</td>
                                </tr>


                                <tr>
                                    <td>Últimos 7 dias</td>
                                    <td>{{ (results['candidatos7Days'] / 7)|round(0, 'ceil') }}</td>
                                    <td>{{ results['candidatos7Days'] }}</td>
                                </tr>

                                <tr>
                                    <td>Últimos 30 dias</td>
                                    <td>{{ (results['candidatos30Days'] /30) |round(0, 'ceil')}}</td>
                                    <td>{{ results['candidatos30Days'] }}</td>
                                </tr>

                                <tr>
                                    <td>Resultado do filtro</td>
                                    <td>{{ (results['candidatosFilter'] /  results['intervalInDays']) |round(0, 'ceil')}}</td>
                                    <td>{{ results['candidatosFilter'] }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>


                    <div class="col">
                        <h2>CURRICULOS</h2>
                        <table class="table  table-striped">
                            <thead>         
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">MÉDIA</th>
                                    <th scope="col">TOTAL</th>
                                </tr>
                            </thead>          

                            <tbody>
                                <tr>
                                    <td>Hoje</td>
                                    <td>{{ results['curriculosToday'] }}</td>
                                    <td>{{ results['curriculosToday'] }}</td>
                                </tr>


                                <tr>
                                    <td>Últimos 7 dias</td>
                                    <td>{{ (results['curriculos7Days'] / 7 ) |round(0, 'ceil')}}</td>
                                    <td>{{ results['curriculos7Days'] }}</td>
                                </tr>

                                <tr>
                                    <td>Últimos 30 dias</td>
                                    <td>{{ (results['curriculos30Days'] /30) |round(0, 'ceil') }}</td>
                                    <td>{{ results['curriculos30Days'] }}</td>
                                </tr>

                                <tr>
                                    <td>Resultado do filtro</td>
                                    <td>{{ (results['curriculosFilter'] /  results['intervalInDays']) |round(0, 'ceil') }}</td>
                                    <td>{{ results['curriculosFilter'] }}</td>
                                </tr>
                            </tbody>
                        </table>



                        <div class="table-wrapper">
                            <table class="table table-sm">

                                <tr>
                                    <td colspan="3"><b>Por Região</b></td>
                                </tr>


                                {% for curriculo in results['curriculosByLocationFilter'] %}
                                    <tr>
                                        <td></td>
                                        <td>{{ curriculo.location }}</td>
                                        <td>{{ curriculo.curriculos }}</td>

                                    </tr>

                                {% endfor %}


                            </table>
                        </div>
                    </div>
                </div>


                <!-- start second row -->
                <div class="row">
                    <div class="col">
                        <br>
                        <h2>VAGAS</h2>
                        <table class="table  table-striped">
                            <thead>         
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">MÉDIA</th>
                                    <th scope="col">TOTAL</th>
                                </tr>
                            </thead>          

                            <tbody>
                                <tr>
                                    <td>Hoje</td>
                                    <td>{{ results['vagasToday'] }}</td>
                                    <td>{{ results['vagasToday'] }}</td>
                                </tr>


                                <tr>
                                    <td>Últimos 7 dias</td>
                                    <td>{{ (results['vagas7Days'] / 7) |round(0, 'ceil') }}</td>
                                    <td>{{ results['vagas7Days'] }}</td>
                                </tr>

                                <tr>
                                    <td>Últimos 30 dias</td>
                                    <td>{{ (results['vagas30Days'] /30) |round(0, 'ceil') }}</td>
                                    <td>{{ results['vagas30Days'] }}</td>
                                </tr>

                                <tr>
                                    <td>Resultado do filtro</td>
                                    <td>{{ (results['vagasFilter'] /  results['intervalInDays']) |round(0, 'ceil') }}</td>
                                    <td>{{ results['vagasFilter'] }}</td>
                                </tr>



                            </tbody>
                        </table>



                        <div class="table-wrapper">
                            <table class="table table-sm">
                                <tr>
                                    <td colspan="3"><b>Por Região</b></td>
                                </tr>
                                {% for vaga in results['vagasByRegionFilter'] %}
                                    <tr>
                                        <td></td>
                                        <td>{{ vaga.region }}</td>
                                        <td>{{ vaga.vagas }}</td>
                                    </tr>
                                {% endfor %}
                            </table>
                        </div>

                    </div>


                    <div class="col">
                        <br>
                        <h2>CANDIDATURAS</h2>
                        <table class="table  table-striped">
                            <thead>         
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">MÉDIA</th>
                                    <th scope="col">TOTAL</th>
                                </tr>
                            </thead>          

                            <tbody>
                                <tr>
                                    <td>Hoje</td>
                                    <td>{{ results['candidaturasToday'] }}</td>
                                    <td>{{ results['candidaturasToday'] }}</td>
                                </tr>


                                <tr>
                                    <td>Últimos 7 dias</td>
                                    <td>{{ (results['candidaturas7Days'] / 7) |round(0, 'ceil') }}</td>
                                    <td>{{ results['candidaturas7Days'] }}</td>
                                </tr>

                                <tr>
                                    <td>Últimos 30 dias</td>
                                    <td>{{ (results['candidaturas30Days'] /30 ) |round(0, 'ceil')}}</td>
                                    <td>{{ results['candidaturas30Days'] }}</td>
                                </tr>

                                <tr>
                                    <td>Resultado do filtro</td>
                                    <td>{{ (results['candidaturasFilter'] /  results['intervalInDays']) |round(0, 'ceil') }}</td>
                                    <td>{{ results['candidaturasFilter'] }}</td>
                                </tr>
                            </tbody>
                        </table>

                                <div class="table-wrapper">
                            <table class="table table-sm">
                                <tr>
                                    <td colspan="3"><b>Por Região</b></td>
                                </tr>
                                {% for candidatura in results['candidaturasByRegionFilter'] %}
                                    <tr>
                                        <td></td>
                                        <td>{{ candidatura.region }}</td>
                                        <td>{{ candidatura.candidaturas }}</td>
                                    </tr>
                                {% endfor %}
                            </table>
                        </div>


                    </div>
                </div>
                <!-- end second row -->





            </div>



            <script type="text/javascript">



                function clearForm() {
                    var elements = document.getElementsByTagName('select');
                    for (var i = 0; i < elements.length; i++)
                    {
                        elements[i].selectedIndex = 0;
                    }


                }
            </script>


        {% endblock %}
